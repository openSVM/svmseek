<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <!-- Enhanced Content Security Policy for better security and iframe compatibility -->
    <meta http-equiv="Content-Security-Policy" content="
      default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https:;
      script-src 'self' 'unsafe-inline' 'unsafe-eval' https://fonts.googleapis.com https://fonts.gstatic.com https://www.googletagmanager.com https://cdn.jsdelivr.net;
      style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://fonts.gstatic.com;
      font-src 'self' data: https://fonts.googleapis.com https://fonts.gstatic.com;
      img-src 'self' data: blob: https:;
      connect-src 'self' https: wss: ws:;
      frame-src 'self' https: blob: data:;
      child-src 'self' https: blob: data:;
      worker-src 'self' blob:;
      media-src 'self' data: blob: https:;
      object-src 'none';
      base-uri 'self';
      form-action 'self';
    ">
    <meta
      name="description"
      content="Wallet™ with support for SPL tokens."
    />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
    <!--
      manifest.json provides metadata used when your web app is installed on a
      user's mobile device or desktop. See https://developers.google.com/web/fundamentals/web-app-manifest/
    -->
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <!--
      Notice the use of %PUBLIC_URL% in the tags above.
      It will be replaced with the URL of the `public` folder during the build.
      Only files inside the `public` folder can be referenced from the HTML.

      Unlike "/oldFavicon.ico" or "oldFavicon.ico", "%PUBLIC_URL%/oldFavicon.ico" will
      work correctly both with client-side routing and a non-root public URL.
      Learn how to configure a non-root public URL by running `npm run build`.
    -->
    <!-- Unicode fonts for all supported languages -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@300;400;500;600;700&family=Noto+Sans+KR:wght@300;400;500;600;700&family=Noto+Sans+JP:wght@300;400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;600;700&family=Noto+Sans+TC:wght@300;400;500;600;700&family=Noto+Sans+Thai:wght@300;400;500;600;700&family=Noto+Sans+Devanagari:wght@300;400;500;600;700&family=Noto+Serif:wght@300;400;500;600;700&family=Noto+Serif+KR:wght@300;400;500;600;700&family=Noto+Serif+JP:wght@300;400;500;600;700&family=Noto+Sans+Mono:wght@300;400;500;600;700&display=swap"
    />

    <link
      rel="preload"
      as="font"
      href="/fonts/AvenirNextCyr-Demi.woff2"
      type="font/woff2"
      crossorigin="anonymous"
    />

    <link
      rel="preload"
      as="font"
      href="/fonts/AvenirNextCyr-Bold.woff2"
      type="font/woff2"
      crossorigin="anonymous"
    />

    <link
      rel="preload"
      as="font"
      href="/fonts/AvenirNextCyr-Medium.woff2"
      type="font/woff2"
      crossorigin="anonymous"
    />

    <link
      rel="preload"
      as="font"
      href="/fonts/AvenirNextCyr-Regular.woff2"
      type="font/woff2"
      crossorigin="anonymous"
    />

    <title>SVMSeek by OpenSVM</title>
    <style>
      @font-face {
        font-family: 'Avenir Next';
        font-style: normal;
        font-weight: 400;
        font-display: block;
        src: local('Avenir Next'), local('AvenirNextCyr-Regular'),
          url('/fonts/AvenirNextCyr-Regular.woff2') format('woff2');
        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6,
          U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193,
          U+2212, U+2215, U+FEFF, U+FFFD;
      }

      @font-face {
        font-family: 'Avenir Next Medium';
        font-style: normal;
        font-weight: 500;
        font-display: block;
        src: local('Avenir Next Medium'), local('AvenirNextCyr-Medium'),
          url('/fonts/AvenirNextCyr-Medium.woff2') format('woff2');
        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6,
          U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193,
          U+2212, U+2215, U+FEFF, U+FFFD;
      }

      @font-face {
        font-family: 'Avenir Next Demi';
        font-style: normal;
        font-weight: 600;
        font-display: block;
        src: local('Avenir Next Demi'), local('AvenirNextCyr-Demi'),
          url('/fonts/AvenirNextCyr-Demi.woff2') format('woff2');
        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6,
          U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193,
          U+2212, U+2215, U+FEFF, U+FFFD;
      }

      @font-face {
        font-family: 'Avenir Next Bold';
        font-style: normal;
        font-weight: 700;
        font-display: block;
        src: local('Avenir Next Bold'), local('AvenirNextCyr-Bold'),
          url('/fonts/AvenirNextCyr-Bold.woff2') format('woff2');
        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6,
          U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193,
          U+2212, U+2215, U+FEFF, U+FFFD;
      }

      html {
        font-size: 10px;
      }

      @media screen and (max-width: 1600px) {
        html {
          font-size: 9px;
        }
      }

      @media screen and (max-width: 1440px) {
        html {
          font-size: 8px;
        }
      }


      @media screen and (min-width: 1920px) {
        html {
          font-size: 11px;
        }
      }

      @media screen and (min-width: 2200px) {
        html {
          font-size: 13px;
        }
      }

      @media screen and (min-width: 2400px) {
        html {
          font-size: 14px;
        }
      }

      @media screen and (min-width: 2560px) {
        html {
          font-size: 15px;
        }
      }



      body {
        margin: 0;
        font-family: 'Avenir Next Medium';
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        background: #17181a !important;
      }

      html,
      body,
      #root {
        height: 100%;
      }

      a, a:hover {
        text-decoration: none;
      }

      input, textarea {
        resize: none;
      }

      .MuiTabs-indicator.MuiTabs-indicator  {
        background: transparent;
      }

      ::-webkit-scrollbar {
        width: 1px;
        height: 1px;
      }

      ::-webkit-scrollbar-thumb {
        background: #651CE4;
      }

      #client-snackbar {
        font-size: 1.6rem;
        color: #fff;
      }
    
    </style>
    
    <!-- CRITICAL: Immediate OS/Buffer polyfill - MUST be first script in head -->
    <script>
      (function() {
        'use strict';
        
        // Comprehensive OS polyfill
        var osPolyfill = {
          EOL: '\n',
          arch: function() { return 'browser'; },
          platform: function() {
            if (typeof navigator !== 'undefined') {
              var ua = navigator.userAgent.toLowerCase();
              if (ua.indexOf('mac') > -1) return 'darwin';
              if (ua.indexOf('win') > -1) return 'win32';
              if (ua.indexOf('linux') > -1) return 'linux';
            }
            return 'browser';
          },
          release: function() { return '1.0.0'; },
          hostname: function() {
            if (typeof window !== 'undefined' && window.location) {
              return window.location.hostname || 'localhost';
            }
            return 'localhost';
          },
          homedir: function() { return '/home/user'; },
          tmpdir: function() { return '/tmp'; },
          userInfo: function() {
            return {
              uid: 1000,
              gid: 1000,
              username: 'user',
              homedir: '/home/user',
              shell: '/bin/bash'
            };
          },
          cpus: function() {
            var numCores = (typeof navigator !== 'undefined' && navigator.hardwareConcurrency) ? navigator.hardwareConcurrency : 4;
            var cores = [];
            for (var i = 0; i < numCores; i++) {
              cores.push({
                model: 'Browser CPU',
                speed: 2400,
                times: { user: 0, nice: 0, sys: 0, idle: 0, irq: 0 }
              });
            }
            return cores;
          },
          freemem: function() { return 256 * 1024 * 1024; },
          totalmem: function() { return 2 * 1024 * 1024 * 1024; },
          loadavg: function() { return [0.1, 0.1, 0.1]; },
          uptime: function() { return Math.floor(Date.now() / 1000); },
          networkInterfaces: function() { return {}; },
          type: function() { return 'browser'; }
        };

        // Path polyfill
        var pathPolyfill = {
          resolve: function() {
            var args = Array.prototype.slice.call(arguments);
            return args.join('/').replace(/\/+/g, '/');
          },
          join: function() {
            var args = Array.prototype.slice.call(arguments);
            return args.join('/').replace(/\/+/g, '/');
          },
          dirname: function(p) {
            return p.split('/').slice(0, -1).join('/') || '/';
          },
          basename: function(p) {
            return p.split('/').pop() || '';
          },
          extname: function(p) {
            var parts = p.split('.');
            return parts.length > 1 ? '.' + parts.pop() : '';
          },
          isAbsolute: function(p) {
            return p.charAt(0) === '/';
          },
          normalize: function(p) {
            return p.replace(/\/+/g, '/');
          }
        };

        // Get all global scopes
        var globalScope = (function() {
          if (typeof globalThis !== 'undefined') return globalThis;
          if (typeof window !== 'undefined') return window;
          if (typeof global !== 'undefined') return global;
          if (typeof self !== 'undefined') return self;
          return {};
        })();

        // Inject into global scope immediately
        if (globalScope && typeof globalScope === 'object') {
          // Set os and path
          globalScope.os = osPolyfill;
          globalScope.path = pathPolyfill;
          
          // CRITICAL: Pre-populate ALL possible webpack variable names
          // Webpack typically uses short variable names in minified code: a, b, c, d, e, etc.
          var allPossibleVarNames = [
            'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 
            'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z',
            'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M',
            'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z',
            'aa', 'ab', 'ac', 'ad', 'ae', 'af', 'ag', 'ah', 'ai', 'aj', 'ak', 'al', 'am',
            'an', 'ao', 'ap', 'aq', 'ar', 'as', 'at', 'au', 'av', 'aw', 'ax', 'ay', 'az',
            'ba', 'bb', 'bc', 'bd', 'be', 'bf', 'bg', 'bh', 'bi', 'bj', 'bk', 'bl', 'bm',
            'bn', 'bo', 'bp', 'bq', 'br', 'bs', 'bt', 'bu', 'bv', 'bw', 'bx', 'by', 'bz',
            'ca', 'cb', 'cc', 'cd', 'ce', 'cf', 'cg', 'ch', 'ci', 'cj', 'ck', 'cl', 'cm',
            'cn', 'co', 'cp', 'cq', 'cr', 'cs', 'ct', 'cu', 'cv', 'cw', 'cx', 'cy', 'cz'
          ];
          
          // Pre-populate all possible variable names with os polyfill
          for (var i = 0; i < allPossibleVarNames.length; i++) {
            var varName = allPossibleVarNames[i];
            if (typeof globalScope[varName] === 'undefined') {
              try {
                globalScope[varName] = osPolyfill;
              } catch (e) {
                // Ignore if we can't set the property
              }
            }
          }

          // Set up require if it doesn't exist
          if (!globalScope.require) {
            globalScope.require = function(moduleName) {
              switch (moduleName) {
                case 'os':
                case 'node:os':
                  return osPolyfill;
                case 'path':
                case 'node:path':
                  return pathPolyfill;
                default:
                  throw new Error('Module ' + moduleName + ' not found');
              }
            };
            globalScope.require.cache = {
              'os': { exports: osPolyfill },
              'node:os': { exports: osPolyfill },
              'path': { exports: pathPolyfill },
              'node:path': { exports: pathPolyfill }
            };
          }

          // Set global reference
          if (!globalScope.global) {
            globalScope.global = globalScope;
          }

          console.log('🛡️ Comprehensive OS polyfill initialized for all variables');
        }

        // Emergency error handler for any missed cases
        if (typeof window !== 'undefined') {
          var originalError = window.onerror;
          window.onerror = function(message, source, lineno, colno, error) {
            if (typeof message === 'string' && message.indexOf('.homedir is not a function') > -1) {
              console.error('🚨 homedir error caught:', message);
              
              // Extract variable name from error
              var match = message.match(/(\w+)\.homedir is not a function/);
              if (match && match[1]) {
                var varName = match[1];
                console.log('🔧 Emergency fix: setting ' + varName + ' to os polyfill');
                
                // Set the problematic variable
                try {
                  window[varName] = osPolyfill;
                  console.log('✅ Successfully set ' + varName);
                  
                  // Try to continue after a brief delay
                  setTimeout(function() {
                    // Try to reload the React app without full page reload
                    if (window.location.hash.indexOf('#') === -1) {
                      window.location.reload();
                    }
                  }, 100);
                  
                  return true; // Prevent default error handling
                } catch (setError) {
                  console.error('❌ Failed to set ' + varName + ':', setError);
                }
              }
            }
            
            // Call original error handler
            if (originalError) {
              return originalError.call(this, message, source, lineno, colno, error);
            }
            return false;
          };
        }
      })();
    </script>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <!-- Load Buffer polyfill first -->
    <script src="%PUBLIC_URL%/buffer-polyfill.js"></script>
    <div id="root">
      <!-- Fallback content for debugging -->
      <div style="
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100vh;
        background: #17181a;
        color: #ffffff;
        font-family: 'Avenir Next Medium', sans-serif;
        text-align: center;
        padding: 20px;
      ">
        <div>
          <div style="font-size: 24px; margin-bottom: 20px;">🔄</div>
          <div style="font-size: 18px; margin-bottom: 10px;">Loading SVMSeek Wallet...</div>
          <div style="font-size: 14px; color: #888;">If this message persists, please check browser console for errors</div>
        </div>
      </div>
    </div>
    <form name="walletFeedback" netlify netlify-honeypot="bot-field" hidden>
      <input type="text" name="message" />
      <input type="text" name="contact" />
    </form>
    <!--
      This HTML file is a template.
      If you open it directly in the browser, you will see an empty page.

      You can add webfonts, meta tags, or analytics to this file.
      The build step will place the bundled scripts into the <body> tag.

      To begin the development, run `npm start` or `yarn start`.
      To create a production bundle, use `npm run build` or `yarn build`.
    -->
  </body>
</html>
